"use strict";var loadCryptoJS=$.getScript("https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js",(function(e,t,n){console.log("crypto js file loaded")})),loadXAPIWrapper=$.getScript("https://gmdoug.sfo3.cdn.digitaloceanspaces.com/xapiwrapper-1-11.js",(function(e,t,n){console.log("xAPI wrapper file loaded")}));function setupXAPIConfig(){CryptoJS.enc.Base64.stringify(CryptoJS.enc.Utf8.parse("coikpi:rolzak"));var e={endpoint:"https://chat-souffle.lrs.io/xapi/",auth:"Basic "+CryptoJS.enc.Base64.stringify(CryptoJS.enc.Utf8.parse("gaodun:ujgizo"))};ADL.XAPIWrapper.changeConfig(e)}$.when(loadCryptoJS,loadXAPIWrapper).done((function(){setupXAPIConfig()})),$.when(loadCryptoJS,loadXAPIWrapper).done((function(){setupXAPIConfig()}));var courseUser="user"+Math.floor(89999999*Math.random()+1e7);"courseUserName"in localStorage||localStorage.setItem("courseUserName",courseUser);var actor=localStorage.getItem("courseUserName")||courseUser,actorMbox="mailto:"+actor+"@doughahn.github.io";function sendVoidStatement(e,t,n,o){var s={actor:{mbox:"mailto:"+e,name:t,objectType:"Agent"},verb:{id:"http://adlnet.gov/expapi/verbs/voided",display:{"en-US":"voided"}},object:{id:n,objectType:"StatementRef"}};ADL.XAPIWrapper.sendStatement(s,(function(e,t){o&&o(e,t)}))}function sendXAPIStatement(e,t){return ADL.XAPIWrapper.sendStatement(e,(function(e,n){if(e&&200!==e.status&&204!==e.status)console.log("xAPI statement send error:",e);else if(console.log("xAPI statement sent, response:",e.status),200===e.status||204===e.status){console.log("Statement successfully received by LRS");var o=document.getElementById(t);o&&o.classList.add("success")}else console.log("There was an issue with the statement delivery to LRS")})),console.log(e),e.id}function getContextWithExperienceLevel(){var e=localStorage.getItem("selectedCategoryGroup");return{contextActivities:{category:[{id:"https://doughahn.github.io/chat-souffle/categories/experience/"+encodeURIComponent(e),objectType:"Activity",definition:{name:{"en-US":e},description:{"en-US":"A category for actors with a "+e}}}]}}}function checkOptionSelected(e){var t=document.querySelector('input[name="'+e+'-choice"]:checked'),n=document.getElementById(e+"-submit");t?n.removeAttribute("disabled"):n.setAttribute("disabled",!0)}window.customLinkHandler=function(e){Engine.play(e)},window.customButtonHandler=function(e){Engine.play(e)},window.checkOptionSelected=checkOptionSelected,$.when(loadCryptoJS,loadXAPIWrapper).done((function(){$(document).on(":passagedisplay",(function(e){var t=window.currentPassage||null,n=e.passage;null!==t&&console.log("Current passage:",t.title),console.log("Incoming passage:",n.title),sendPassageLoadedStatement(t?t.title:null,n.title),window.currentPassage=n}))})),window.sendPassageLoadedStatement=function(e,t){setupXAPIConfig(),sendXAPIStatement({actor:{mbox:actorMbox,name:actor,objectType:"Agent"},verb:{id:"https://w3id.org/xapi/netc/verbs/accessed",display:{"en-US":"accessed"}},object:{id:"https://yourdomain.com/twine-game/passages/"+encodeURIComponent(t),definition:{name:{"en-US":t},description:{"en-US":"Twine game passage: "+t}},objectType:"Activity"},result:{response:e?"Accessed "+t+" from "+e:"Started at "+t}})};var ids={"history-forward":{name:"Navigation Click Forward",description:"the user clicked the forward button"},"history-backward":{name:"Navigation Click Backward",description:"the user clicked the backward button"},"menu-item-restart":{name:"Navigation Click Restart",description:"the user clicked the restart button"},"menu-item-saves":{name:"Navigation Click Saves",description:"the user clicked the saves button"}},passageName="My Passage Name";function sendButtonClickStatement(e){setupXAPIConfig();var t="doughahn@gmail.com",n=actor,o=localStorage.getItem("last"+e+"ClickStatementId");o&&sendVoidStatement(t,n,o,(function(e,t){e&&200!==e.status&&204!==e.status?console.log("xAPI void statement send error:",e):console.log("xAPI void statement sent, response:",e.status)}));var s=sendXAPIStatement({actor:{mbox:"mailto:"+t,name:n,objectType:"Agent"},verb:{id:"http://adlnet.gov/expapi/verbs/interacted",display:{"en-US":"interacted"}},object:{id:"https://doughahn.github.io/chat-souffle/"+e,definition:{name:{"en-US":e+" Click Test"},description:{"en-US":"User Interacted with the "+e+" Button."}},objectType:"Activity"},result:{response:"User clicked the "+e+" button."},context:getContextWithExperienceLevel()},e);s&&localStorage.setItem("last"+e+"ClickStatementId",s)}function sendLinkClickStatement(e){setupXAPIConfig();var t="doughahn@gmail.com",n=actor,o=localStorage.getItem("last"+e+"ClickStatementId");o&&sendVoidStatement(t,n,o,(function(e,t){e&&200!==e.status&&204!==e.status?console.log("xAPI void statement send error:",e):console.log("xAPI void statement sent, response:",e.status)}));var s=sendXAPIStatement({actor:{mbox:"mailto:"+t,name:n,objectType:"Agent"},verb:{id:"http://adlnet.gov/expapi/verbs/interacted",display:{"en-US":"interacted"}},object:{id:"https://doughahn.github.io/chat-souffle/"+e,definition:{name:{"en-US":e+" Click Test"},description:{"en-US":"User Interacted with the "+e+" Link."}},objectType:"Activity"},result:{response:"User clicked the "+e+" link."},context:getContextWithExperienceLevel()},e);s&&localStorage.setItem("last"+e+"ClickStatementId",s)}function sendFormXAPIStatement(e){setupXAPIConfig();var t="doughahn@gmail.com",n=actor,o=localStorage.getItem("last"+e+"StatementId");o&&sendVoidStatement(t,n,o,(function(e,t){e&&200!==e.status&&204!==e.status?console.log("xAPI void statement send error:",e):console.log("xAPI void statement sent, response:",e.status)}));var s=document.querySelector('input[name="'+e+'-choice"]:checked').value,a=s.toLowerCase().replace(/\s+/g,"-"),i={actor:{mbox:"mailto:"+t,name:n,objectType:"Agent"},verb:{id:"https://w3id.org/xapi/dod-isd/verbs/chose",display:{"en-US":"answered"}},object:{id:"https://doughahn.github.io/chat-souffle/"+e,definition:{name:{"en-US":"Experience Self-Assessment"},description:{"en-US":"The user's self-assessment of experience in multiple choice assessment"}},objectType:"Activity"},result:{response:s},context:{contextActivities:{grouping:[{id:"https://doughahn.github.io/chat-souffle/groups/"+e+"/"+a,objectType:"Activity",definition:{name:{"en-US":s+" Group"},description:{"en-US":"A group for actors who chose "+s+" on "+e}}}]}}};localStorage.setItem("selectedCategoryGroup",s);var c=sendXAPIStatement(i,e+"-submit");if(c){localStorage.setItem("last"+e+"StatementId",c);var r=document.getElementById(e+"-submit");r.classList.remove(".resubmit-success"),r.classList.add(".success");r.textContent;r.textContent="Success!",setTimeout((function(){r.textContent="Re-submit",r.classList.remove(".success"),r.classList.add(".resubmit-success")}),2e3)}}function sendTextareaXAPIStatement(e,t,n){setupXAPIConfig();sendXAPIStatement({actor:{mbox:"mailto:doughahn@gmail.com",name:actor,objectType:"Agent"},verb:{id:"http://adlnet.gov/expapi/verbs/answered",display:{"en-US":"answered"}},object:{id:n,definition:{name:{"en-US":"Textarea Sample"},description:{"en-US":"Input Area Sample"}},objectType:"Activity"},result:{response:document.getElementById(e).value}},t),document.getElementById(t).disabled=!0}function checkTextareaNotEmpty(e,t){var n=document.getElementById(e).value,o=document.getElementById(t);0===n.length?o.disabled=!0:o.disabled=!1}Object.keys(ids).forEach((function(e){document.getElementById(e).addEventListener("click",(function(){var t=passage(),n=ids[e].description+" from "+t;setupXAPIConfig(),sendXAPIStatement({actor:{mbox:"mailto:doughahn@gmail.com",name:actor,objectType:"Agent"},verb:{id:"https://w3id.org/xapi/dod-isd/verbs/interacted",display:{"en-US":"answered"}},object:{id:"https://doughahn.github.io/chat-souffle/"+e,definition:{name:{"en-US":ids[e].name},description:{"en-US":ids[e].description}},objectType:"Activity"},result:{response:n}}),console.log(n)}))})),window.handleButtonStartSurvey1=function(){sendButtonClickStatement("buttonStartSurvey1")},window.handleButtonSurvey1to2=function(){sendButtonClickStatement("survey-1-submit")},window.handleButtonSurvey2to3=function(){sendButtonClickStatement("survey-2-submit")},window.handleButtonSurvey3toText=function(){sendButtonClickStatement("survey-3-submit")},document.addEventListener("DOMContentLoaded",(function(){document.getElementById("self-assess-more-feedback").addEventListener("click",(function(){sendLinkClickStatement("self-assess-more-feedback")})),document.getElementById("self-assess-early-exit").addEventListener("click",(function(){sendLinkClickStatement("self-assess-early-exit")}))})),window.sendFormXAPIStatement=sendFormXAPIStatement,window.sendTextareaXAPIStatement=sendTextareaXAPIStatement,window.checkTextareaNotEmpty=checkTextareaNotEmpty,window.send_completion=function(){setupXAPIConfig();var e="doughahn@gmail.com",t=actor,n=localStorage.getItem("lastTestButtonClickStatementId");n&&sendVoidStatement(e,t,n,(function(e,t){e&&200!==e.status&&204!==e.status?console.log("xAPI void statement send error:",e):console.log("xAPI void statement sent, response:",e.status)}));var o=sendXAPIStatement({actor:{mbox:"mailto:"+e,name:t,objectType:"Agent"},verb:{id:"http://adlnet.gov/expapi/verbs/interacted",display:{"en-US":"completed"}},object:{id:"https://doughahn.github.io/chat-souffle/completed-self-assessment-early-release",definition:{name:{"en-US":"Completed Self Assessment on early release"},description:{"en-US":"User Completed Self Assessment on early release."}},objectType:"Activity"},result:{response:"User Completed Self Assessment on early release."},context:getContextWithExperienceLevel()},"completedButton");o&&(localStorage.setItem("completedButton",o),document.getElementById("completedButton").disabled=!0)};