"use strict";var loadCryptoJS=$.getScript("https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js",(function(e,t,s){console.log("crypto js file loaded")})),loadXAPIWrapper=$.getScript("https://gmdoug.sfo3.cdn.digitaloceanspaces.com/xapiwrapper-1-11.js",(function(e,t,s){console.log("xAPI wrapper file loaded")}));function setupXAPIConfig(){var e={endpoint:"https://sample-lrs-befogih.lrs.io/xapi/",auth:"Basic "+CryptoJS.enc.Base64.stringify(CryptoJS.enc.Utf8.parse("coikpi:rolzak"))},t={endpoint:"https://chat-souffle.lrs.io/xapi/",auth:"Basic "+CryptoJS.enc.Base64.stringify(CryptoJS.enc.Utf8.parse("gaodun:ujgizo"))};setupXAPIConfig.environment="production","development"===setupXAPIConfig.environment?ADL.XAPIWrapper.changeConfig(e):ADL.XAPIWrapper.changeConfig(t)}function displayDevWarningBanner(){if("development"===setupXAPIConfig.environment){var e=document.createElement("div");e.innerHTML="Using Dev LRS",e.style.backgroundColor="yellow",e.style.color="black",e.style.textAlign="center",e.style.fontWeight="bold",e.style.padding="1rem",e.style.position="fixed",e.style.bottom="0",e.style.left="0",e.style.width="100%",e.style.zIndex="1000",document.body.appendChild(e)}}$.when(loadCryptoJS,loadXAPIWrapper).done((function(){setupXAPIConfig()})),$.when(loadCryptoJS,loadXAPIWrapper).done((function(){setupXAPIConfig()})),$(document).on(":passagedisplay",(function(e){setTimeout(displayDevWarningBanner,0)}));var courseUser="user"+Math.floor(89999999*Math.random()+1e7);"courseUserName"in localStorage||localStorage.setItem("courseUserName",courseUser);var actor=localStorage.getItem("courseUserName")||courseUser,actorMbox="mailto:"+actor+"@doughahn.github.io";function sendVoidStatement(e,t,s,n){var o={actor:{mbox:"mailto:"+e,name:t,objectType:"Agent"},verb:{id:"http://adlnet.gov/expapi/verbs/voided",display:{"en-US":"voided"}},object:{id:s,objectType:"StatementRef"}};ADL.XAPIWrapper.sendStatement(o,(function(e,t){n&&n(e,t)}))}function sendXAPIStatement(e,t){return ADL.XAPIWrapper.sendStatement(e,(function(e,s){if(e&&200!==e.status&&204!==e.status)console.log("xAPI statement send error:",e);else if(console.log("xAPI statement sent, response:",e.status),200===e.status||204===e.status){console.log("Statement successfully received by LRS");var n=document.getElementById(t);n&&n.classList.add("success")}else console.log("There was an issue with the statement delivery to LRS")})),console.log(JSON.stringify(e,null,"\t")),e.id}function getContextWithExperienceLevel(){var e=localStorage.getItem("selectedCategoryGroup");return{contextActivities:{category:[{id:"https://doughahn.github.io/chat-souffle/categories/experience/"+encodeURIComponent(e),objectType:"Activity",definition:{name:{"en-US":e},description:{"en-US":"A category for actors with a "+e}}}]}}}localStorage.setItem("actor",actor),$(document).on(":passagerender",(function(e,t){var s=State.variables.devConf,n=State.variables.prodConf;if(s&&!n){var o=document.createElement("div");o.innerHTML="Using Dev LRS",o.style.backgroundColor="red",o.style.color="white",o.style.fontWeight="bold",o.style.padding="5px",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.zIndex="1000",t.content.appendChild(o)}}));var completedPassages=[],allPassages=["Start","self assessment 1","self assessment 2","self assessment 3","self assessment general feedback","complete assessment","set up chatgpt","test drive chatgpt","writing assessments","improve an assessment","provided assessment track 1","provided assessment track 1 freeform","criteria for effective distractors","provided assessment track 2","provided assessment track 2 freeform","provided assessment track 3","provided assessment track 3 freeform","provided assessment track 4","provided assessment track 4 freeform","provided assessment track exit","custom assessment track 1","criteria for effective custom distractors","custom assessment track 2","custom assessment track 2 freeform","custom assessment track 3","custom assessment track 3 freeform","custom assessment track 4","custom assessment track 4 freeform","custom track 5","post survey 1","post survey 2","post survey 3 freeform","thank you"],passageGroups={"self-assessment":["start","self assessment 1","self assessment 2","self assessment 3","self assessment exit or feedback","self assessment general feedback","complete assessment"],setup:["set up chatgpt","test drive chatgpt","writing assessments","improve an assessment"],track1:["provided assessment track 1","provided assessment track 1 freeform","criteria for effective distractors","provided assessment track 2 freeform","criteria for effective distractors","provided assessment track 2","provided assessment track 2 freeform","provided assessment track 3","provided assessment track 3 freeform","provided assessment track 4","provided assessment track 4 freeform","provided assessment track exit"],track2:["custom assessment track 1","custom assessment track 2","custom assessment track 2 freeform","custom assessment track 3","custom assessment track 3 freeform","custom assessment track 4","custom track 5"],postSurvey:["post survey 1","post survey 2","post survey 3 freeform","thank you"]},groupTitles={"self-assessment":"Self assessment",setup:"Setup & review criteria",track1:"Track 1: Use a provided assessment",track2:"Track 2: Use a custom assessment",postSurvey:"Complete the course"};function updateProgress(e){-1===completedPassages.indexOf(e)&&completedPassages.push(e),displayProgress()}function displayProgress(){var e=document.getElementById("progress-tracker");if(e){var t={};for(var s in passageGroups){var n=groupTitles[s]||s;t[s]='<div class="group '.concat(s,'"><h5>').concat(n,"</h5>")}for(var s in allPassages.forEach((function(e){var s="";for(var n in s=-1!==completedPassages.indexOf(e)?"fa-solid fa-circle completed":"fa-solid fa-circle",passageGroups)if(-1!==passageGroups[n].indexOf(e)){t[n]+='\n          <div class="passage-container '.concat(n,'">\n            <i class="').concat(s,'"></i>\n          </div>');break}})),t)t[s]+="</div>";var o="";for(var s in t)o+=t[s];e.innerHTML=o}}function checkOptionSelected(e){var t=document.querySelector('input[name="'+e+'-choice"]:checked'),s=document.getElementById(e+"-submit");t?s.removeAttribute("disabled"):s.setAttribute("disabled",!0)}$(document).on(":passagedisplay",(function(e){updateProgress(e.passage.title),displayProgress()})),window.updateVisitCount=function(e,t){var s=t?visited(t):visited(),n=document.getElementById(e);n?n.textContent=s:console.warn('Element with ID "'+e+'" not found.')},window.customLinkHandler=function(e){Engine.play(e)},window.customButtonHandler=function(e){Engine.play(e)},window.checkOptionSelected=checkOptionSelected,window.setupClipboardCopy=function(){document.querySelectorAll(".copyButton").forEach((function(e){e.addEventListener("click",(function(){var e=this,t=this.previousElementSibling.innerText;navigator.clipboard.writeText(t).then((function(){console.log("Text copied to clipboard");var t=e.nextElementSibling;setTimeout((function(){t.classList.remove("show")}),1e3),e.innerText="Copied",e.classList.add("copied")})).catch((function(e){console.error("Error copying text: ",e)}))}))}))},$.when(loadCryptoJS,loadXAPIWrapper).done((function(){$(document).on(":passagedisplay",(function(e){var t=window.currentPassage||null,s=e.passage;null!==t&&console.log("Current passage:",t.title),console.log("Incoming passage:",s.title),sendPassageLoadedStatement(t?t.title:null,s.title),window.currentPassage=s}))})),window.sendPassageLoadedStatement=function(e,t){setupXAPIConfig(),sendXAPIStatement({actor:{mbox:actorMbox,name:actor,objectType:"Agent"},verb:{id:"https://w3id.org/xapi/netc/verbs/accessed",display:{"en-US":"accessed"}},object:{id:"https://doughahn.github.io/chat-souffle/"+encodeURIComponent(t),definition:{name:{"en-US":t},description:{"en-US":"Twine game passage: "+t}},objectType:"Activity"},result:{response:e?"Accessed "+t+" from "+e:"Started at "+t}})};var ids={"history-forward":{name:"Navigation Click Forward",description:"the user clicked the forward button"},"history-backward":{name:"Navigation Click Backward",description:"the user clicked the backward button"},"menu-item-restart":{name:"Navigation Click Restart",description:"the user clicked the restart button"},"menu-item-saves":{name:"Navigation Click Saves",description:"the user clicked the saves button"}},passageName="My Passage Name";function sendButtonClickStatement(e){setupXAPIConfig();var t="team.chatsouffle@gmail.com",s=actor,n=localStorage.getItem("last"+e+"ClickStatementId");n&&sendVoidStatement(t,s,n,(function(e,t){e&&200!==e.status&&204!==e.status?console.log("xAPI void statement send error:",e):console.log("xAPI void statement sent, response:",e.status)}));var o=sendXAPIStatement({actor:{mbox:"mailto:"+t,name:s,objectType:"Agent"},verb:{id:"http://adlnet.gov/expapi/verbs/interacted",display:{"en-US":"interacted"}},object:{id:"https://doughahn.github.io/chat-souffle/"+e,definition:{name:{"en-US":e+" Click Test"},description:{"en-US":"User Interacted with the "+e+" Button."}},objectType:"Activity"},result:{response:"User clicked the "+e+" button."},context:getContextWithExperienceLevel()},e);o&&localStorage.setItem("last"+e+"ClickStatementId",o)}function sendLinkClickStatement(e){setupXAPIConfig();var t="team.chatsouffle@gmail.com",s=actor,n=localStorage.getItem("last"+e+"ClickStatementId");n&&sendVoidStatement(t,s,n,(function(e,t){e&&200!==e.status&&204!==e.status?console.log("xAPI void statement send error:",e):console.log("xAPI void statement sent, response:",e.status)}));var o=sendXAPIStatement({actor:{mbox:"mailto:"+t,name:s,objectType:"Agent"},verb:{id:"http://adlnet.gov/expapi/verbs/interacted",display:{"en-US":"interacted"}},object:{id:"https://doughahn.github.io/chat-souffle/"+e,definition:{name:{"en-US":e+" Click Test"},description:{"en-US":"User Interacted with the "+e+" Link."}},objectType:"Activity"},result:{response:"User clicked the "+e+" link."},context:getContextWithExperienceLevel()},e);o&&localStorage.setItem("last"+e+"ClickStatementId",o)}function sendFormXAPIStatement(e){setupXAPIConfig();var t="team.chatsouffle@gmail.com",s=actor,n=document.getElementById(e).dataset.parent,o=localStorage.getItem("last"+e+"StatementId");o&&sendVoidStatement(t,s,o,(function(e,t){e&&200!==e.status&&204!==e.status?console.log("xAPI void statement send error:",e):console.log("xAPI void statement sent, response:",e.status)}));var a=document.querySelector('input[name="'+e+'-choice"]:checked').value,i=a.toLowerCase().replace(/\s+/g,"-"),r={actor:{mbox:"mailto:"+t,name:s,objectType:"Agent"},verb:{id:"https://w3id.org/xapi/dod-isd/verbs/chose",display:{"en-US":"answered"}},object:{id:"https://doughahn.github.io/chat-souffle/"+e,definition:{name:{"en-US":e},description:{"en-US":"the user's choice on "+e}},objectType:"Activity"},result:{response:a},context:{contextActivities:{parent:[{id:"https://doughahn.github.io/chat-souffle/paths/"+n,objectType:"Activity",definition:{name:{"en-US":n},description:{"en-US":"The parent path of the current activity"}}}],grouping:[{id:"https://doughahn.github.io/chat-souffle/groups/"+e+"/"+i,objectType:"Activity",definition:{name:{"en-US":a+" Group"},description:{"en-US":"A group for actors who chose "+a+" on "+e}}}]}}};localStorage.setItem("selectedCategoryGroup",a);var c=sendXAPIStatement(r,e+"-submit");if(c){localStorage.setItem("last"+e+"StatementId",c);var d=document.getElementById(e+"-submit");d.classList.remove(".resubmit-success"),d.classList.add(".success");d.textContent;d.textContent="Success!",setTimeout((function(){d.textContent="Re-submit",d.classList.remove(".success"),d.classList.add(".resubmit-success")}),2e3)}}function sendFormXAPIStatementNoVoid(e){setupXAPIConfig();var t=actor,s=document.getElementById(e).dataset.parent,n=document.querySelector('input[name="'+e+'-choice"]:checked').value,o=n.toLowerCase().replace(/\s+/g,"-"),a={actor:{mbox:"mailto:team.chatsouffle@gmail.com",name:t,objectType:"Agent"},verb:{id:"https://w3id.org/xapi/dod-isd/verbs/chose",display:{"en-US":"answered"}},object:{id:"https://doughahn.github.io/chat-souffle/"+e,definition:{name:{"en-US":e},description:{"en-US":"the user's choice on "+e}},objectType:"Activity"},result:{response:n},context:{contextActivities:{parent:[{id:"https://doughahn.github.io/chat-souffle/paths/"+s,objectType:"Activity",definition:{name:{"en-US":s},description:{"en-US":"The parent path of the current activity"}}}],grouping:[{id:"https://doughahn.github.io/chat-souffle/groups/"+e+"/"+o,objectType:"Activity",definition:{name:{"en-US":n+" Group"},description:{"en-US":"A group for actors who chose "+n+" on "+e}}}]}}};localStorage.setItem("selectedCategoryGroup",n);var i=sendXAPIStatement(a,e+"-submit");if(i){localStorage.setItem("last"+e+"StatementId",i);var r=document.getElementById(e+"-submit");r.classList.remove(".resubmit-success"),r.classList.add(".success");r.textContent;r.textContent="Success!",setTimeout((function(){r.textContent="Re-submit",r.classList.remove(".success"),r.classList.add(".resubmit-success")}),2e3)}}function sendTextareaXAPIStatement(e,t,s){console.log("activityId: ",s),setupXAPIConfig();var n=actor,o=document.getElementById(e).value,a=document.getElementById(e).parentNode.dataset.parent;sendXAPIStatement({actor:{mbox:"mailto:doughahn@gmail.com",name:n,objectType:"Agent"},verb:{id:"http://adlnet.gov/expapi/verbs/answered",display:{"en-US":"answered"}},object:{id:"https://doughahn.github.io/chat-souffle/"+s,definition:{name:{"en-US":s},description:{"en-US":"Answered "+s}},objectType:"Activity"},result:{response:o},context:{contextActivities:{grouping:[{id:"https://doughahn.github.io/chat-souffle/paths/"+a,objectType:"Activity",definition:{name:{"en-US":a},description:{"en-US":"The parent path of the current activity"}}}]}}},t),document.getElementById(t).disabled=!0}function checkTextareaNotEmpty(e,t){var s=document.getElementById(e).value,n=document.getElementById(t);0===s.length?n.disabled=!0:n.disabled=!1}function attachExternalLinkEventListener(){$(".external-link").each((function(){$(this).on("click",(function(e){e.preventDefault();var t=$(this).attr("id");window.sendExternalLinkClickStatement(t),window.open($(this).attr("href"),"_blank")}))}))}Object.keys(ids).forEach((function(e){document.getElementById(e).addEventListener("click",(function(){var t=passage(),s=ids[e].description+" from "+t;setupXAPIConfig(),sendXAPIStatement({actor:{mbox:"mailto:team.chatsouffle@gmail.com",name:actor,objectType:"Agent"},verb:{id:"https://w3id.org/xapi/dod-isd/verbs/interacted",display:{"en-US":"answered"}},object:{id:"https://doughahn.github.io/chat-souffle/"+e,definition:{name:{"en-US":ids[e].name},description:{"en-US":ids[e].description}},objectType:"Activity"},result:{response:s}}),console.log(s)}))})),window.handleButtonStartSurvey1=function(){sendButtonClickStatement("buttonStartSurvey1")},window.handleButtonSurvey1to2=function(){sendButtonClickStatement("survey-1-submit")},window.handleButtonSurvey2to3=function(){sendButtonClickStatement("survey-2-submit")},window.handleButtonSurvey3toText=function(){sendButtonClickStatement("survey-3-submit")},document.addEventListener("DOMContentLoaded",(function(){document.getElementById("self-assess-more-feedback").addEventListener("click",(function(){sendLinkClickStatement("self-assess-more-feedback")})),document.getElementById("self-assess-early-exit").addEventListener("click",(function(){sendLinkClickStatement("self-assess-early-exit")})),document.getElementById("provided-criteria").addEventListener("click",(function(){sendLinkClickStatement("provided-criteria")}))})),window.send_completion=function(){setupXAPIConfig();var e="team.chatsouffle@gmail.com",t=actor,s=localStorage.getItem("lastTestButtonClickStatementId");s&&sendVoidStatement(e,t,s,(function(e,t){e&&200!==e.status&&204!==e.status?console.log("xAPI void statement send error:",e):console.log("xAPI void statement sent, response:",e.status)}));var n=sendXAPIStatement({actor:{mbox:"mailto:"+e,name:t,objectType:"Agent"},verb:{id:"http://adlnet.gov/expapi/verbs/interacted",display:{"en-US":"completed"}},object:{id:"https://doughahn.github.io/chat-souffle/completed-self-assessment-early-release",definition:{name:{"en-US":"Completed Self Assessment on early release"},description:{"en-US":"User Completed Self Assessment on early release."}},objectType:"Activity"},result:{response:"User Completed Self Assessment on early release."},context:getContextWithExperienceLevel()},"completedButton");n&&(localStorage.setItem("completedButton",n),document.getElementById("completedButton").disabled=!0)},window.sendFormXAPIStatement=sendFormXAPIStatement,window.sendFormXAPIStatementNoVoid=sendFormXAPIStatementNoVoid,window.sendTextareaXAPIStatement=sendTextareaXAPIStatement,window.checkTextareaNotEmpty=checkTextareaNotEmpty,setup.trackStarts=0,setup.trackCompletions=0,setup.iterationActivities={},setup.currentIterationId=null,setup.trackStartsTrack2=0,setup.trackCompletionsTrack2=0,Config.saves.onSave=function(e){e.metadata.iterationActivities=setup.iterationActivities},Config.saves.onLoad=function(e){e.metadata.iterationActivities&&(setup.iterationActivities=e.metadata.iterationActivities)},window.handleXAPIClick=function(e){var t=e.target.id;window.handleButtonClick(t)},window.handleButtonClick=function(e){setup.currentIterationId="iteration_"+(setup.trackStarts+1),window.incrementTrackCompletions(setup.currentIterationId,e)},window.incrementTrackCompletions=function(e,t){(setup.trackCompletions++,console.log("Track completions: "+setup.trackCompletions),e)&&sendXAPIStatement({actor:{name:actor,mbox:"mailto:team.chatsouffle@gmail.com"},verb:{id:"https://w3id.org/xapi/adb/verbs/completed",display:{"en-US":"completed"}},object:{id:"https://doughahn.github.io/chat-souffle/"+e+"/button/"+t,definition:{name:{"en-US":"Track "+e+" - Button "+t},description:{"en-US":"Loop # "+setup.trackCompletions+" completed"}}}})},window.addCompleteTrackListener=function(){for(var e=document.getElementsByClassName("complete-track-1"),t=document.getElementsByClassName("complete-track-2"),s=0;s<e.length;s++)e[s].addEventListener("click",(function(e){var t=e.target.id;window.handleButtonClick(t)}));for(s=0;s<t.length;s++)t[s].addEventListener("click",(function(e){var t=e.target.id;window.handleButtonClickTrack2(t)}))},window.handleButtonClickTrack2=function(e){setup.currentIterationId="iteration_track2_"+(setup.trackStartsTrack2+1),window.incrementTrackCompletionsTrack2(setup.currentIterationId,e)},window.handleXAPIClickTrack2=function(e){var t=e.target.id;window.handleButtonClickTrack2(t)},window.incrementTrackCompletionsTrack2=function(e,t){(setup.trackCompletionsTrack2++,console.log("Track 2 completions: "+setup.trackCompletionsTrack2),e)&&sendXAPIStatement({actor:{name:actor,mbox:"mailto:team.chatsouffle@gmail.com"},verb:{id:"https://w3id.org/xapi/adb/verbs/completed",display:{"en-US":"completed"}},object:{id:"https://doughahn.github.io/chat-souffle/"+e+"/button/"+t,definition:{name:{"en-US":"Track "+e+" - Button "+t},description:{"en-US":"Loop # "+setup.trackCompletionsTrack2+" completed"}}}})},document.addEventListener("DOMContentLoaded",(function(){window.addCompleteTrackListener()})),window.sendExternalLinkClickStatement=function(e){var t=document.getElementById(e).href;setupXAPIConfig();var s=actor,n=(localStorage.getItem("last"+e+"ClickStatementId"),sendXAPIStatement({actor:{mbox:"mailto:team.chatsouffle@gmail.com",name:s,objectType:"Agent"},verb:{id:"http://adlnet.gov/expapi/activities/link",display:{"en-US":"link"}},object:{id:"https://doughahn.github.io/chat-souffle/"+e,definition:{name:{"en-US":e},description:{"en-US":"User linked the "+e+" Link."}},objectType:"Activity"},result:{response:"User linked the "+e+" link with URL: "+t}},e));n&&localStorage.setItem("last"+e+"ClickStatementId",n)},$(document).on(":passagedisplay",(function(){console.log("Passage displayed"),attachExternalLinkEventListener()}));